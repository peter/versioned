{
    "swagger": "2.0",
    "info": {
        "title": "Versioned API",
        "description": "A REST CMS API based on MongoDB",
        "version": "0.2.0"
    },
    "host": "versioned.herokuapp.com",
    "schemes": [
        "https"
    ],
    "basePath": "/v1",
    "produces": [
        "application/json"
    ],
    "paths": {
        "/login": {
            "post": {
                "tags": ["login"],
                "summary": "Login",
                "description": "Log in user with email/password and get token",
                "parameters": [
                    {
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                          "type": "object",
                          "properties": {
                            "email": {"type": "string"},
                            "password": {"type": "string"}
                          },
                          "required": ["email", "password"]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful login"
                    },
                    "401": {
                        "description": "Failed login"
                    }
                }
            }
        },
        "/bulk_import": {
            "post": {
                "tags": ["import"],
                "summary": "Bulk Import",
                "description": "Import data, i.e. from another CMS",
                "parameters": [
                    {"$ref": "#/parameters/auth"},
                    {
                        "name": "body",
                        "in": "body",
                        "required": true,
                        "schema": {
                          "type": "object",
                          "properties": {
                            "model": {"$ref": "#/definitions/model_param"},
                            "data": {
                              "type": "array",
                              "items": {
                                "type": "object"
                              }
                            }
                          },
                          "required": ["model", "data"]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful import"
                    },
                    "422": {
                        "description": "Import errors"
                    }
                }
            }
        },
        "/pages": {
          "parameters": [
            {"$ref": "#/parameters/auth"}
          ],
          "get": {
            "tags": ["pages"],
            "summary": "List pages",
            "responses": {
              "200": {
                  "description": "List of pages"
              }
            }
          },
          "post": {
            "tags": ["pages"],
            "summary": "Create page",
            "parameters": [
              {
                "name": "body",
                "in": "body",
                "required": true,
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "attributes": {"$ref": "#/definitions/users_write"}
                      },
                      "required": ["attributes"]
                    }
                  },
                  "required": ["data"]
                }
              }
            ],
            "responses": {
              "200": {
                  "description": "Success"
              },
              "422": {
                  "description": "Validation errors"
              }
            }
          }
        },
        "/pages/{id}": {
          "parameters": [
            {"$ref": "#/parameters/auth"},
            {"$ref": "#/parameters/id"}
          ],
          "get": {
            "tags": ["pages"],
            "summary": "Get page",
            "responses": {
              "200": {
                  "description": "Success"
              }
            }
          },
          "put": {
            "tags": ["pages"],
            "summary": "Update page",
            "parameters": [
              {
                "name": "body",
                "in": "body",
                "required": true,
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "attributes": {"$ref": "#/definitions/users_write"}
                      },
                      "required": ["attributes"]
                    }
                  },
                  "required": ["data"]
                }
              }
            ],
            "responses": {
              "200": {
                  "description": "Success"
              },
              "422": {
                  "description": "Validation errors"
              }
            }
          },
          "delete": {
            "tags": ["pages"],
            "summary": "Delete page",
            "responses": {
              "200": {
                  "description": "Success"
              }
            }
          }
        }
    },
    "definitions": {
      "model_param": {
        "enum": ["users", "sections", "pages", "widgets"]
      },
      "users_write": {
        "type" : "object",
        "properties" : {
          "description" : {
            "type" : "object",
            "additionalProperties": {
                "type" : "string"
            }
          },
          "published_version" : {
            "type" : "integer",
            "minimum" : 1
          },
          "slug" : {
            "type" : "object",
            "additionalProperties": {
                "type" : "string"
            }
          },
          "sites" : {
            "type" : "array",
            "items" : {
              "enum" : [ "se", "no", "dk", "fi" ]
            }
          },
          "title" : {
            "type" : "object",
            "additionalProperties": {
                "type" : "string"
            }
          },
          "widgets_ids" : {
            "type" : "array",
            "items" : {
              "type" : "integer"
            }
          }
        },
        "required" : ["title"],
        "additionalProperties" : false
      }
    },
    "parameters": {
      "auth": {
        "name": "Authorization",
        "in": "header",
        "required": true,
        "type": "string"
      },
      "id": {
        "name": "id",
        "in": "path",
        "required": true,
        "type": "integer"
      }
    }
}
